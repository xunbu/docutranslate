<p align="center">
<img src="./DocuTranslate.png" alt="é¡¹ç›®Logo" style="width: 150px">
</p>

<h1 align="center">DocuTranslate</h1>

<p align="center">
  <a href="https://github.com/xunbu/docutranslate/stargazers"><img src="https://img.shields.io/github/stars/xunbu/docutranslate?style=flat-square&logo=github&color=blue" alt="GitHub stars"></a>
  <a href="https://github.com/xunbu/docutranslate/releases"><img src="https://img.shields.io/github/downloads/xunbu/docutranslate/total?logo=github&style=flat-square" alt="GitHub Downloads"></a>
  <a href="https://pypi.org/project/docutranslate/"><img src="https://img.shields.io/pypi/v/docutranslate?style=flat-square" alt="PyPI version"></a>
  <a href="https://www.python.org/"><img src="https://img.shields.io/badge/Python-3.11+-3776AB?logo=python&logoColor=white&style=flat-square" alt="Python Version"></a>
  <a href="./LICENSE"><img src="https://img.shields.io/github/license/xunbu/docutranslate?style=flat-square" alt="License"></a>
</p>

<p align="center">
  <a href="/README_ZH.md"><strong>ç®€ä½“ä¸­æ–‡</strong></a> / <a href="/README.md"><strong>English</strong></a> / <a href="/README_JP.md"><strong>æ—¥æœ¬èª</strong></a>
</p>

<p align="center">
  ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„è½»é‡çº§æœ¬åœ°æ–‡ä»¶ç¿»è¯‘å·¥å…·
</p>

- âœ… **æ”¯æŒå¤šç§æ ¼å¼**ï¼šèƒ½ç¿»è¯‘ `pdf`ã€`docx`ã€`xlsx`ã€`md`ã€`txt`ã€`json`ã€`epub`ã€`srt` ã€`ass`ç­‰å¤šç§æ–‡ä»¶ã€‚
- âœ… **è‡ªåŠ¨ç”Ÿæˆæœ¯è¯­è¡¨**ï¼šæ”¯æŒè‡ªåŠ¨ç”Ÿæˆæœ¯è¯­è¡¨å®ç°æœ¯è¯­çš„å¯¹é½ã€‚
- âœ… **PDFè¡¨æ ¼ã€å…¬å¼ã€ä»£ç è¯†åˆ«**ï¼šå‡­å€Ÿ`docling`ã€`mineru`pdfè§£æå¼•æ“å®ç°å¯¹å­¦æœ¯è®ºæ–‡ä¸­ç»å¸¸å‡ºç°çš„è¡¨æ ¼ã€å…¬å¼ã€ä»£ç çš„è¯†åˆ«ä¸ç¿»è¯‘
- âœ… **jsonç¿»è¯‘**ï¼šæ”¯æŒé€šè¿‡jsonè·¯å¾„(`jsonpath-ng`è¯­æ³•è§„èŒƒ)æŒ‡å®šjsonä¸­éœ€è¦è¢«ç¿»è¯‘çš„å€¼ã€‚
- âœ… **Word/Excelä¿æŒæ ¼å¼ç¿»è¯‘**ï¼šæ”¯æŒ`docx`ã€`xlsx`æ–‡ä»¶ï¼ˆæš‚ä¸æ”¯æŒ`doc`ã€`xls`æ–‡ä»¶ï¼‰ä¿æŒåŸæ ¼å¼è¿›è¡Œç¿»è¯‘ã€‚
- âœ… **å¤šaiå¹³å°æ”¯æŒ**ï¼šæ”¯æŒç»å¤§éƒ¨åˆ†çš„aiå¹³å°ï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰æç¤ºè¯çš„å¹¶å‘é«˜æ€§èƒ½aiç¿»è¯‘ã€‚
- âœ… **å¼‚æ­¥æ”¯æŒ**ï¼šä¸“ä¸ºé«˜æ€§èƒ½åœºæ™¯è®¾è®¡ï¼Œæä¾›å®Œæ•´çš„å¼‚æ­¥æ”¯æŒï¼Œå®ç°äº†å¯ä»¥å¤šä»»åŠ¡å¹¶è¡Œçš„æœåŠ¡æ¥å£ã€‚
- âœ… **å±€åŸŸç½‘ã€å¤šäººä½¿ç”¨æ”¯æŒ**ï¼šæ”¯æŒåœ¨å±€åŸŸç½‘ä¸­å¤šäººåŒæ—¶ä½¿ç”¨ã€‚
- âœ… **äº¤äº’å¼Webç•Œé¢**ï¼šæä¾›å¼€ç®±å³ç”¨çš„ Web UI å’Œ RESTful APIï¼Œæ–¹ä¾¿é›†æˆä¸ä½¿ç”¨ã€‚
- âœ… **å°ä½“ç§¯ã€å¤šå¹³å°æ‡’äººåŒ…æ”¯æŒ**ï¼šä¸åˆ°40Mçš„windowsã€macæ‡’äººåŒ…ï¼ˆä¸ä½¿ç”¨`docling`æœ¬åœ°è§£æpdfçš„ç‰ˆæœ¬ï¼‰ã€‚

> åœ¨ç¿»è¯‘`pdf`æ—¶ä¼šå…ˆè½¬æ¢ä¸ºmarkdownï¼Œè¿™ä¼š**ä¸¢å¤±**åŸå…ˆçš„æ’ç‰ˆï¼Œå¯¹æ’ç‰ˆæœ‰è¦æ±‚çš„ç”¨æˆ·è¯·æ³¨æ„

> QQäº¤æµç¾¤ï¼š1047781902

**UIç•Œé¢**ï¼š
![ç¿»è¯‘æ•ˆæœ](/images/UIç•Œé¢.png)

**è®ºæ–‡ç¿»è¯‘**ï¼š
![ç¿»è¯‘æ•ˆæœ](/images/è®ºæ–‡ç¿»è¯‘.png)

**å°è¯´ç¿»è¯‘**ï¼š
![ç¿»è¯‘æ•ˆæœ](/images/å°è¯´ç¿»è¯‘.png)

## æ•´åˆåŒ…

å¯¹äºå¸Œæœ›å¿«é€Ÿä¸Šæ‰‹çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬åœ¨ [GitHub Releases](https://github.com/xunbu/docutranslate/releases) ä¸Šæä¾›æ•´åˆåŒ…ã€‚æ‚¨åªéœ€ä¸‹è½½ã€è§£å‹ï¼Œå¹¶å¡«å…¥æ‚¨çš„
AI å¹³å° API-Key å³å¯å¼€å§‹ä½¿ç”¨ã€‚

- **DocuTranslate**: æ ‡å‡†ç‰ˆï¼Œä½¿ç”¨ `minerU`ï¼ˆåœ¨çº¿æˆ–æœ¬åœ°éƒ¨ç½²ï¼‰è§£æPDFæ–‡æ¡£ï¼Œæ”¯æŒè°ƒç”¨æœ¬åœ°éƒ¨ç½²çš„ minerU APIã€‚ï¼ˆæ¨èï¼‰
- **DocuTranslate_full**: å®Œæ•´ç‰ˆï¼Œå†…ç½® `docling` æœ¬åœ°PDFè§£æå¼•æ“ï¼Œæ— éœ€ minerU å³å¯è¿›è¡Œç¦»çº¿PDFè§£ææ—¶é€‰æ‹©æ­¤ç‰ˆæœ¬ã€‚

## å®‰è£…

### ä½¿ç”¨ pip

```bash
# åŸºç¡€å®‰è£…
pip install docutranslate

# å¦‚éœ€ä½¿ç”¨ docling æœ¬åœ°è§£æPDF
pip install docutranslate[docling]
```

### ä½¿ç”¨ uv

```bash
# åˆå§‹åŒ–ç¯å¢ƒ
uv init

# åŸºç¡€å®‰è£…
uv add docutranslate

# å®‰è£… docling æ‰©å±•
uv add docutranslate[docling]
```

### ä½¿ç”¨ git

```bash
# åˆå§‹åŒ–ç¯å¢ƒ
git clone https://github.com/xunbu/docutranslate.git

cd docutranslate

uv sync

```

### ä½¿ç”¨docker

```bash
docker run -d -p 8010:8010 xunbu/docutranslate:latest
# docker run -it -p 8010:8010 xunbu/docutranslate:latest
# docker run -it -p 8010:8010 xunbu/docutranslate:v1.5.4
```

## æ ¸å¿ƒæ¦‚å¿µï¼šå·¥ä½œæµ (Workflow)

DocuTranslate ä½¿ç”¨ **å·¥ä½œæµ (Workflow)** ç³»ç»Ÿï¼Œæ¯ä¸ªå·¥ä½œæµéƒ½æ˜¯é’ˆå¯¹ç‰¹å®šæ–‡ä»¶ç±»å‹çš„å®Œæ•´ç¿»è¯‘ç®¡é“ã€‚

**åŸºæœ¬æµç¨‹ï¼š**
1. æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©å·¥ä½œæµ
2. é…ç½®å·¥ä½œæµï¼ˆLLMã€è§£æå¼•æ“ã€è¾“å‡ºæ ¼å¼ï¼‰
3. æ‰§è¡Œç¿»è¯‘
4. ä¿å­˜ç»“æœ

## å¯åŠ¨ Web UI å’Œ API æœåŠ¡

ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼ŒDocuTranslate æä¾›äº†ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„ Web ç•Œé¢å’Œ RESTful APIã€‚

**å¯åŠ¨æœåŠ¡:**

```bash
# å¯åŠ¨æœåŠ¡ï¼Œé»˜è®¤ç›‘å¬ 8010 ç«¯å£
docutranslate -i

# æŒ‡å®šç«¯å£å¯åŠ¨
docutranslate -i -p 8011

# å…è®¸è·¨åŸŸè¯·æ±‚
docutranslate -i --cors


# ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šç«¯å£
export DOCUTRANSLATE_PORT=8011
docutranslate -i
```

- **äº¤äº’å¼ç•Œé¢**: å¯åŠ¨æœåŠ¡åï¼Œè¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://127.0.0.1:8010` (æˆ–æ‚¨æŒ‡å®šçš„ç«¯å£)ã€‚
- **API æ–‡æ¡£**: å®Œæ•´çš„ API æ–‡æ¡£ï¼ˆSwagger UIï¼‰ä½äº `http://127.0.0.1:8010/docs`ã€‚

## ä½¿ç”¨æ–¹å¼

### ä½¿ç”¨ç®€å•çš„ Client SDK (æ¨è)

ä½¿ç”¨ `Client` ç±»æ˜¯å¼€å§‹ç¿»è¯‘æœ€ç®€å•çš„æ–¹å¼ï¼Œå®ƒæä¾›äº†ç®€æ´ç›´è§‚çš„ APIï¼š

```python
from docutranslate.sdk import Client

# ä½¿ç”¨æ‚¨çš„ AI å¹³å°è®¾ç½®åˆå§‹åŒ–å®¢æˆ·ç«¯
client = Client(
    api_key="YOUR_OPENAI_API_KEY",  # æˆ–å…¶ä»– AI å¹³å° API key
    base_url="https://api.openai.com/v1/",
    model_id="gpt-4o",
    to_lang="ä¸­æ–‡",
    concurrent=10,  # å¹¶å‘è¯·æ±‚æ•°
)

# ç¿»è¯‘å•ä¸ªæ–‡ä»¶ (è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹)
result = client.translate("path/to/your/document.pdf")

# ä½¿ç”¨é»˜è®¤æ ¼å¼ä¿å­˜ (PDF -> markdown with embedded images)
print(f"ç¿»è¯‘å®Œæˆï¼ä¿å­˜ä½ç½®: {result.save()}")

# æˆ–æ˜¾å¼æŒ‡å®šè¾“å‡ºæ ¼å¼
# PDF/markdown_based æ”¯æŒ:
#   - "markdown": Markdown æ ¼å¼ï¼Œå†…åµŒ base64 å›¾ç‰‡ (é»˜è®¤)
#   - "markdown_zip": Markdown æ ¼å¼ï¼Œå›¾ç‰‡åˆ†ç¦»å­˜å‚¨ (ZIP å‹ç¼©åŒ…)
#   - "html": HTML æ ¼å¼
# docx æ”¯æŒ: "docx"
# xlsx æ”¯æŒ: "xlsx"
result.save(fmt="html")  # ä¿å­˜ä¸º HTML
result.save(fmt="markdown")  # ä¿å­˜ä¸º Markdownï¼ˆå†…åµŒå›¾ç‰‡ï¼‰
result.save(fmt="markdown_zip")  # ä¿å­˜ä¸º ZIPï¼ˆå›¾ç‰‡åˆ†ç¦»ï¼‰

# ä¿å­˜åˆ°è‡ªå®šä¹‰ä½ç½®
result.save(output_dir="./my_translations", name="my_document.html")

# å¯¼å‡ºä¸º Base64 ç¼–ç å­—ç¬¦ä¸²
base64_content = result.export(fmt="html")
print(f"å¯¼å‡ºå†…å®¹é•¿åº¦: {len(base64_content)}")

# æ‚¨è¿˜å¯ä»¥è®¿é—®åº•å±‚å·¥ä½œæµä»¥è¿›è¡Œé«˜çº§æ“ä½œ
# workflow = result.workflow
```

**Client åŠŸèƒ½ç‰¹ç‚¹:**
- **è‡ªåŠ¨æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹å¹¶é€‰æ‹©åˆé€‚çš„å·¥ä½œæµ
- **çµæ´»é…ç½®**: å¯åœ¨æ¯æ¬¡ç¿»è¯‘è°ƒç”¨æ—¶è¦†ç›–é»˜è®¤è®¾ç½®
- **å¤šç§è¾“å‡ºé€‰é¡¹**: ä¿å­˜åˆ°ç£ç›˜æˆ–å¯¼å‡ºä¸º Base64 å­—ç¬¦ä¸²
- **å¼‚æ­¥æ”¯æŒ**: ä½¿ç”¨ `translate_async()` è¿›è¡Œå¹¶å‘ç¿»è¯‘ä»»åŠ¡

#### Client SDK å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|:---|:---|:---|:---|
| **api_key** | `str` | - | AI å¹³å° API å¯†é’¥ |
| **base_url** | `str` | - | AI å¹³å°åŸºç¡€ URLï¼ˆå¦‚ `https://api.openai.com/v1/`ï¼‰ |
| **model_id** | `str` | - | ç¿»è¯‘ä½¿ç”¨çš„æ¨¡å‹ ID |
| **to_lang** | `str` | - | ç›®æ ‡è¯­è¨€ï¼ˆå¦‚ `"ä¸­æ–‡"`ã€`"English"`ã€`"æ—¥æœ¬èª"`ï¼‰ |
| **concurrent** | `int` | 10 | å¹¶å‘ LLM è¯·æ±‚æ•° |
| **convert_engine** | `str` | `"mineru"` | PDF è§£æå¼•æ“ï¼š`"mineru"`ã€`"docling"`ã€`"mineru_deploy"` |
| **mineru_deploy_base_url** | `str` | - | æœ¬åœ° minerU API åœ°å€ï¼ˆå½“ `convert_engine="mineru_deploy"` æ—¶ï¼‰ |
| **mineru_token** | `str` | - | minerU API Tokenï¼ˆä½¿ç”¨åœ¨çº¿ minerU æ—¶ï¼‰ |
| **skip_translate** | `bool` | `False` | è·³è¿‡ç¿»è¯‘ï¼Œä»…è§£ææ–‡æ¡£ |
| **output_dir** | `str` | `"./output"` | `save()` æ–¹æ³•çš„é»˜è®¤è¾“å‡ºç›®å½• |
| **chunk_size** | `int` | 3000 | LLM å¤„ç†çš„æ–‡æœ¬åˆ†å—å¤§å° |
| **temperature** | `float` | 0.3 | LLM æ¸©åº¦å‚æ•° |
| **timeout** | `int` | 60 | è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| **retry** | `int` | 3 | å¤±è´¥é‡è¯•æ¬¡æ•° |
| **provider** | `str` | `"auto"` | AI æä¾›å•†ç±»å‹ï¼ˆautoã€openaiã€azure ç­‰ï¼‰ |
| **force_json** | `bool` | `False` | å¼ºåˆ¶ JSON è¾“å‡ºæ¨¡å¼ |
| **rpm** | `int` | - | æ¯åˆ†é’Ÿè¯·æ±‚æ•°é™åˆ¶ |
| **tpm** | `int` | - | æ¯åˆ†é’Ÿ Token æ•°é™åˆ¶ |

#### Result æ–¹æ³•è¯´æ˜

| æ–¹æ³• | å‚æ•° | è¯´æ˜ |
|:---|:---|:---|
| **save()** | `output_dir`, `name`, `fmt` | å°†ç¿»è¯‘ç»“æœä¿å­˜åˆ°ç£ç›˜ |
| **export()** | `fmt` | å¯¼å‡ºä¸º Base64 ç¼–ç çš„å­—ç¬¦ä¸² |
| **supported_formats** | - | è·å–æ”¯æŒçš„è¾“å‡ºæ ¼å¼åˆ—è¡¨ |
| **workflow** | - | è®¿é—®åº•å±‚å·¥ä½œæµå¯¹è±¡ |

```python
import asyncio
from docutranslate.sdk import Client

async def translate_multiple():
    client = Client(
        api_key="YOUR_API_KEY",
        base_url="https://api.openai.com/v1/",
        model_id="gpt-4o",
        to_lang="ä¸­æ–‡",
    )

    # å¹¶å‘ç¿»è¯‘å¤šä¸ªæ–‡ä»¶
    files = ["doc1.pdf", "doc2.docx", "notes.txt"]
    results = await asyncio.gather(
        *[client.translate_async(f) for f in files]
    )

    for r in results:
        print(f"ä¿å­˜ä½ç½®: {r.save()}")

asyncio.run(translate_multiple())
```

### ä½¿ç”¨ Workflow APIï¼ˆé«˜çº§æ§åˆ¶ï¼‰

å¦‚éœ€æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¯ç›´æ¥ä½¿ç”¨ Workflow APIã€‚æ‰€æœ‰å·¥ä½œæµéµå¾ªç›¸åŒæ¨¡å¼ï¼š

```python
# æ¨¡å¼:
# 1. åˆ›å»º TranslatorConfigï¼ˆLLM è®¾ç½®ï¼‰
# 2. åˆ›å»º WorkflowConfigï¼ˆå·¥ä½œæµè®¾ç½®ï¼‰
# 3. åˆ›å»º Workflow å®ä¾‹
# 4. workflow.read_path(æ–‡ä»¶)
# 5. await workflow.translate_async()
# 6. workflow.save_as_*(name=...) æˆ– export_to_*(...)
```

#### å¯ç”¨å·¥ä½œæµåŠè¾“å‡ºæ–¹æ³•

| å·¥ä½œæµ | è¾“å…¥æ ¼å¼ | save_as_* | export_to_* | å…³é”®é…ç½®é€‰é¡¹ |
|:---|:---|:---|:---|:---|
| **MarkdownBasedWorkflow** | `.pdf`, `.docx`, `.md`, `.png`, `.jpg` | `html`, `markdown`, `markdown_zip` | `html`, `markdown`, `markdown_zip` | `convert_engine`, `translator_config` |
| **TXTWorkflow** | `.txt` | `txt`, `html` | `txt`, `html` | `translator_config` |
| **JsonWorkflow** | `.json` | `json`, `html` | `json`, `html` | `translator_config`, `json_paths` |
| **DocxWorkflow** | `.docx` | `docx`, `html` | `docx`, `html` | `translator_config`, `insert_mode` |
| **XlsxWorkflow** | `.xlsx`, `.csv` | `xlsx`, `html` | `xlsx`, `html` | `translator_config`, `insert_mode` |
| **SrtWorkflow** | `.srt` | `srt`, `html` | `srt`, `html` | `translator_config` |
| **EpubWorkflow** | `.epub` | `epub`, `html` | `epub`, `html` | `translator_config`, `insert_mode` |
| **HtmlWorkflow** | `.html`, `.htm` | `html` | `html` | `translator_config`, `insert_mode` |
| **AssWorkflow** | `.ass` | `ass`, `html` | `ass`, `html` | `translator_config` |

#### å…³é”®é…ç½®é€‰é¡¹

**é€šç”¨ TranslatorConfig é€‰é¡¹ï¼š**

| é€‰é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|:---|:---|:---|:---|
| `base_url` | `str` | - | AI å¹³å°åŸºç¡€ URL |
| `api_key` | `str` | - | AI å¹³å° API å¯†é’¥ |
| `model_id` | `str` | - | æ¨¡å‹ ID |
| `to_lang` | `str` | - | ç›®æ ‡è¯­è¨€ |
| `chunk_size` | `int` | 3000 | æ–‡æœ¬åˆ†å—å¤§å° |
| `concurrent` | `int` | 10 | å¹¶å‘è¯·æ±‚æ•° |
| `temperature` | `float` | 0.3 | LLM æ¸©åº¦ |
| `timeout` | `int` | 60 | è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰ |
| `retry` | `int` | 3 | é‡è¯•æ¬¡æ•° |

**æ ¼å¼ç‰¹å®šé€‰é¡¹ï¼š**

| é€‰é¡¹ | é€‚ç”¨å·¥ä½œæµ | è¯´æ˜ |
|:---|:---|:---|
| `insert_mode` | Docx, Xlsx, Html, Epub | `"replace"`ï¼ˆé»˜è®¤ï¼‰, `"append"`, `"prepend"` |
| `json_paths` | Json | JSONPath è¡¨è¾¾å¼ï¼ˆå¦‚ `["$.*", "$.name"]`ï¼‰ |
| `separator` | Docx, Xlsx, Html, Epub | append/prepend æ¨¡å¼çš„æ–‡æœ¬åˆ†éš”ç¬¦ |
| `convert_engine` | MarkdownBased | `"mineru"`ï¼ˆé»˜è®¤ï¼‰, `"docling"`, `"mineru_deploy"` |

#### ç¤ºä¾‹ 1: ç¿»è¯‘ä¸€ä¸ª PDF æ–‡ä»¶ (ä½¿ç”¨ `MarkdownBasedWorkflow`)

è¿™æ˜¯æœ€å¸¸è§çš„ç”¨ä¾‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ `minerU` å¼•æ“å°† PDF è½¬æ¢ä¸º Markdownï¼Œç„¶åä½¿ç”¨ LLM è¿›è¡Œç¿»è¯‘ã€‚è¿™é‡Œä»¥å¼‚æ­¥æ–¹å¼ä¸ºä¾‹ã€‚

```python
import asyncio
from docutranslate.workflow.md_based_workflow import MarkdownBasedWorkflow, MarkdownBasedWorkflowConfig
from docutranslate.converter.x2md.converter_mineru import ConverterMineruConfig
from docutranslate.translator.ai_translator.md_translator import MDTranslatorConfig
from docutranslate.exporter.md.md2html_exporter import MD2HTMLExporterConfig


async def main():
    # 1. æ„å»ºç¿»è¯‘å™¨é…ç½®
    translator_config = MDTranslatorConfig(
        base_url="https://open.bigmodel.cn/api/paas/v4",  # AI å¹³å° Base URL
        api_key="YOUR_ZHIPU_API_KEY",  # AI å¹³å° API Key
        model_id="glm-4-air",  # æ¨¡å‹ ID
        to_lang="English",  # ç›®æ ‡è¯­è¨€
        chunk_size=3000,  # æ–‡æœ¬åˆ†å—å¤§å°
        concurrent=10,  # å¹¶å‘æ•°
        # glossary_generate_enable=True, # å¯ç”¨è‡ªåŠ¨ç”Ÿæˆæœ¯è¯­è¡¨
        # glossary_dict={"Jobs":"ä¹”å¸ƒæ–¯"}, # ä¼ å…¥æœ¯è¯­è¡¨
        # system_proxy_enable=True,# å¯ç”¨ç³»ç»Ÿä»£ç†
    )

    # 2. æ„å»ºè½¬æ¢å™¨é…ç½® (ä½¿ç”¨ minerU)
    converter_config = ConverterMineruConfig(
        mineru_token="YOUR_MINERU_TOKEN",  # ä½ çš„ minerU Token
        formula_ocr=True  # å¼€å¯å…¬å¼è¯†åˆ«
    )

    # 3. æ„å»ºä¸»å·¥ä½œæµé…ç½®
    workflow_config = MarkdownBasedWorkflowConfig(
        convert_engine="mineru",  # æŒ‡å®šè§£æå¼•æ“
        converter_config=converter_config,  # ä¼ å…¥è½¬æ¢å™¨é…ç½®
        translator_config=translator_config,  # ä¼ å…¥ç¿»è¯‘å™¨é…ç½®
        html_exporter_config=MD2HTMLExporterConfig(cdn=True)  # HTML å¯¼å‡ºé…ç½®
    )

    # 4. å®ä¾‹åŒ–å·¥ä½œæµ
    workflow = MarkdownBasedWorkflow(config=workflow_config)

    # 5. è¯»å–æ–‡ä»¶å¹¶æ‰§è¡Œç¿»è¯‘
    print("å¼€å§‹è¯»å–å’Œç¿»è¯‘æ–‡ä»¶...")
    workflow.read_path("path/to/your/document.pdf")
    await workflow.translate_async()
    # æˆ–è€…ä½¿ç”¨åŒæ­¥çš„æ–¹å¼
    # workflow.translate()
    print("ç¿»è¯‘å®Œæˆï¼")

    # 6. ä¿å­˜ç»“æœ
    workflow.save_as_html(name="translated_document.html")
    workflow.save_as_markdown_zip(name="translated_document.zip")
    workflow.save_as_markdown(name="translated_document.md")  # åµŒå…¥å›¾ç‰‡çš„markdown
    print("æ–‡ä»¶å·²ä¿å­˜åˆ° ./output æ–‡ä»¶å¤¹ã€‚")

    # æˆ–è€…ç›´æ¥è·å–å†…å®¹å­—ç¬¦ä¸²
    html_content = workflow.export_to_html()
    html_content = workflow.export_to_markdown()
    # print(html_content)


if __name__ == "__main__":
    asyncio.run(main())
```

### å…¶ä»–å·¥ä½œæµ

æ‰€æœ‰å·¥ä½œæµéƒ½éµå¾ªç›¸åŒçš„æ¨¡å¼ã€‚å¯¼å…¥å¯¹åº”çš„é…ç½®å’Œå·¥ä½œæµï¼Œç„¶åè¿›è¡Œé…ç½®ï¼š

```python
# TXT: from docutranslate.workflow.txt_workflow import TXTWorkflow, TXTWorkflowConfig
# JSON: from docutranslate.workflow.json_workflow import JsonWorkflow, JsonWorkflowConfig
# DOCX: from docutranslate.workflow.docx_workflow import DocxWorkflow, DocxWorkflowConfig
# XLSX: from docutranslate.workflow.xlsx_workflow import XlsxWorkflow, XlsxWorkflowConfig
# EPUB: from docutranslate.workflow.epub_workflow import EpubWorkflow, EpubWorkflowConfig
# HTML: from docutranslate.workflow.html_workflow import HtmlWorkflow, HtmlWorkflowConfig
# SRT:  from docutranslate.workflow.srt_workflow import SrtWorkflow, SrtWorkflowConfig
# ASS:   from docutranslate.workflow.ass_workflow import AssWorkflow, AssWorkflowConfig
```

ä¸»è¦é…ç½®é€‰é¡¹ï¼š
- **insert_mode**: `"replace"`, `"append"`, `"prepend"` (ç”¨äº docx/xlsx/html/epub)
- **json_paths**: JSONPath è¡¨è¾¾å¼ç”¨äº JSON ç¿»è¯‘ (ä¾‹å¦‚ `["$.*", "$.name"]`)
- **separator**: ç”¨äº `"append"` / `"prepend"` æ¨¡å¼çš„æ–‡æœ¬åˆ†éš”ç¬¦

## å‰ç½®æ¡ä»¶ä¸é…ç½®è¯¦è§£

### 1. è·å–å¤§æ¨¡å‹ API Key

ç¿»è¯‘åŠŸèƒ½ä¾èµ–äºå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæ‚¨éœ€è¦ä»ç›¸åº”çš„ AI å¹³å°è·å– `base_url`, `api_key` å’Œ `model_id`ã€‚

> æ¨èæ¨¡å‹ï¼šç«å±±å¼•æ“çš„`doubao-seed-1-6-flash`ã€`doubao-seed-1-6`ç³»åˆ—ã€æ™ºè°±çš„`glm-4-flash`ï¼Œé˜¿é‡Œäº‘çš„ `qwen-plus`ã€`qwen-flash`
> ï¼Œdeepseekçš„`deepseek-chat`ç­‰ã€‚

> [302.AI](https://share.302.ai/BgRLAe)ğŸ‘ˆä»è¯¥é“¾æ¥æ³¨å†Œå¯äº«1ç¾å…ƒå…è´¹é¢åº¦

| å¹³å°åç§°       | è·å–APIkey                                                                              | baseurl                                                  |
|------------|---------------------------------------------------------------------------------------|----------------------------------------------------------|
| ollama     |                                                                                       | http://127.0.0.1:11434/v1                                |
| lm studio  |                                                                                       | http://127.0.0.1:1234/v1                                 |
| 302.AI     | [ç‚¹å‡»è·å–](https://share.302.ai/BgRLAe)                                                   | https://api.302.ai/v1                                    |
| openrouter | [ç‚¹å‡»è·å–](https://openrouter.ai/settings/keys)                                           | https://openrouter.ai/api/v1                             |
| openai     | [ç‚¹å‡»è·å–](https://platform.openai.com/api-keys)                                          | https://api.openai.com/v1/                               |
| gemini     | [ç‚¹å‡»è·å–](https://aistudio.google.com/u/0/apikey)                                        | https://generativelanguage.googleapis.com/v1beta/openai/ |
| deepseek   | [ç‚¹å‡»è·å–](https://platform.deepseek.com/api_keys)                                        | https://api.deepseek.com/v1                              |
| æ™ºè°±ai       | [ç‚¹å‡»è·å–](https://open.bigmodel.cn/usercenter/apikeys)                                   | https://open.bigmodel.cn/api/paas/v4                     |
| è…¾è®¯æ··å…ƒ       | [ç‚¹å‡»è·å–](https://console.cloud.tencent.com/hunyuan/api-key)                             | https://api.hunyuan.cloud.tencent.com/v1                 |
| é˜¿é‡Œäº‘ç™¾ç‚¼      | [ç‚¹å‡»è·å–](https://bailian.console.aliyun.com/?tab=model#/api-key)                        | https://dashscope.aliyuncs.com/compatible-mode/v1        |
| ç«å±±å¼•æ“       | [ç‚¹å‡»è·å–](https://console.volcengine.com/ark/region:ark+cn-beijing/apiKey?apikey=%7B%7D) | https://ark.cn-beijing.volces.com/api/v3                 |
| ç¡…åŸºæµåŠ¨       | [ç‚¹å‡»è·å–](https://cloud.siliconflow.cn/account/ak)                                       | https://api.siliconflow.cn/v1                            |
| DMXAPI     | [ç‚¹å‡»è·å–](https://www.dmxapi.cn/token)                                                   | https://www.dmxapi.cn/v1                                 |
| èšå…‰AI       | [ç‚¹å‡»è·å–](https://ai.juguang.chat/console/token)                                         | https://ai.juguang.chat/v1                               |

### 2. PDFè§£æå¼•æ“ï¼ˆä¸éœ€è¦ç¿»è¯‘PDFçš„æ— éœ€å…³å¿ƒæ­¤å¤„ï¼‰

### 2.1 è·å– minerU Token (åœ¨çº¿è§£æPDFï¼Œå…è´¹ï¼Œæ¨è)

å¦‚æœæ‚¨é€‰æ‹© `mineru`ä½œä¸ºæ–‡æ¡£è§£æå¼•æ“ï¼ˆ`convert_engine="mineru"`ï¼‰ï¼Œåˆ™éœ€è¦ç”³è¯·ä¸€ä¸ªå…è´¹çš„ Tokenã€‚

1. è®¿é—® [minerU å®˜ç½‘](https://mineru.net/apiManage/docs) æ³¨å†Œå¹¶ç”³è¯· APIã€‚
2. åœ¨ [API Token ç®¡ç†ç•Œé¢](https://mineru.net/apiManage/token) åˆ›å»ºä¸€ä¸ªæ–°çš„ API Tokenã€‚

> **æ³¨æ„**: minerU Token æœ‰ 14 å¤©æœ‰æ•ˆæœŸï¼Œè¿‡æœŸåè¯·é‡æ–°åˆ›å»ºã€‚

### 2.2. docling å¼•æ“é…ç½® (æœ¬åœ°è§£æPDF)

å¦‚æœæ‚¨é€‰æ‹© `docling` ä½œä¸ºæ–‡æ¡£è§£æå¼•æ“ï¼ˆ`convert_engine="docling"`ï¼‰ï¼Œå®ƒä¼šåœ¨é¦–æ¬¡ä½¿ç”¨æ—¶ä» Hugging Face ä¸‹è½½æ‰€éœ€çš„æ¨¡å‹ã€‚

> æ›´å¥½çš„é€‰æ‹©æ˜¯åœ¨[github releases](https://github.com/xunbu/docutranslate/releases)ä¸‹è½½`docling_artifact.zip`è§£å‹åˆ°å·¥ä½œç›®å½•ä¸‹ã€‚

**ä¸‹è½½`docling`æ¨¡å‹ç½‘ç»œé—®é¢˜è§£å†³æ–¹æ¡ˆ:**

1. **è®¾ç½® Hugging Face é•œåƒ (æ¨è)**:

* **æ–¹æ³• A (ç¯å¢ƒå˜é‡)**: è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ `HF_ENDPOINT` å¹¶é‡å¯æ‚¨çš„IDEæˆ–ç»ˆç«¯ã€‚
   ```
   HF_ENDPOINT=https://hf-mirror.com
   ```
* **æ–¹æ³• B (ä»£ç ä¸­è®¾ç½®)**: åœ¨æ‚¨çš„ Python è„šæœ¬å¼€å¤´æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚

```python
import os

os.environ['HF_ENDPOINT'] = 'https://hf-mirror.com'
```

2. **ç¦»çº¿ä½¿ç”¨ (æå‰ä¸‹è½½æ¨¡å‹åŒ…)**:

* ä» [GitHub Releases](https://github.com/xunbu/docutranslate/releases) ä¸‹è½½ `docling_artifact.zip`ã€‚
* å°†å…¶è§£å‹åˆ°æ‚¨çš„é¡¹ç›®ç›®å½•ä¸­ã€‚
* åœ¨é…ç½®ä¸­æŒ‡å®šæ¨¡å‹è·¯å¾„ï¼ˆè‹¥æ¨¡å‹ä¸åœ¨è„šæœ¬åŒçº§ç›®å½•é‡Œï¼‰ï¼š

```python
from docutranslate.converter.x2md.converter_docling import ConverterDoclingConfig

converter_config = ConverterDoclingConfig(
    artifact="./docling_artifact",  # æŒ‡å‘è§£å‹åçš„æ–‡ä»¶å¤¹
    code_ocr=True,
    formula_ocr=True
)
```

### 2.3. æœ¬åœ°éƒ¨ç½² MinerU æœåŠ¡

åœ¨ç¦»çº¿æˆ–å†…ç½‘ç¯å¢ƒä¸­ï¼Œæ¨èä½¿ç”¨æœ¬åœ°éƒ¨ç½²çš„ `minerU`ï¼Œæ€§èƒ½æ›´å¥½ä¸”æ—  API é™åˆ¶ã€‚è®¾ç½® `mineru_deploy_base_url` ä¸ºæ‚¨çš„ minerU API åœ°å€ã€‚

**Client SDK:**
```python
from docutranslate.sdk import Client

client = Client(
    api_key="YOUR_LLM_API_KEY",
    model_id="llama3",
    to_lang="ä¸­æ–‡",
    convert_engine="mineru_deploy",
    mineru_deploy_base_url="http://127.0.0.1:8000",  # æ‚¨çš„ minerU API åœ°å€
)
result = client.translate("document.pdf")
result.save(fmt="markdown")
```

## FAQ

**Q: ç¿»è¯‘å‡ºæ¥çš„è¿˜æ˜¯åŸæ–‡ï¼Ÿ**
A: æŸ¥çœ‹æ—¥å¿—æŠ¥é”™ï¼Œé€šå¸¸æ˜¯ AI å¹³å°æ¬ è´¹æˆ–ç½‘ç»œé—®é¢˜ã€‚

**Q: 8010 ç«¯å£è¢«å ç”¨ï¼Ÿ**
A: ä½¿ç”¨ `docutranslate -i -p 8011` æˆ–è®¾ç½® `DOCUTRANSLATE_PORT=8011`ã€‚

**Q: æ”¯æŒ PDF æ‰«æä»¶ï¼Ÿ**
A: æ”¯æŒï¼Œä½¿ç”¨ `mineru` å¼•æ“å…·å¤‡ OCR èƒ½åŠ›ã€‚

**Q: ç¬¬ä¸€æ¬¡ç¿»è¯‘ PDF å¾ˆæ…¢ï¼Ÿ**
A: `docling` é¦–æ¬¡éœ€è¦ä¸‹è½½æ¨¡å‹ã€‚ä½¿ç”¨ Hugging Face é•œåƒæˆ–é¢„ä¸‹è½½ artifactã€‚

**Q: å†…ç½‘/ç¦»çº¿ç¯å¢ƒä½¿ç”¨ï¼Ÿ**
A: å¯ä»¥ã€‚ä½¿ç”¨æœ¬åœ° LLMï¼ˆOllama/LM Studioï¼‰å’Œæœ¬åœ° minerU æˆ– doclingã€‚

**Q: PDF ç¼“å­˜æœºåˆ¶ï¼Ÿ**
A: `MarkdownBasedWorkflow` åœ¨å†…å­˜ä¸­ç¼“å­˜è§£æç»“æœï¼ˆæœ€è¿‘ 10 æ¬¡ï¼‰ã€‚å¯é€šè¿‡ `DOCUTRANSLATE_CACHE_NUM` é…ç½®ã€‚

**Q: å¯ç”¨ä»£ç†ï¼Ÿ**
A: åœ¨ TranslatorConfig ä¸­è®¾ç½® `system_proxy_enable=True`ã€‚

## Star History

<a href="https://www.star-history.com/#xunbu/docutranslate&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=xunbu/docutranslate&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=xunbu/docutranslate&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=xunbu/docutranslate&type=Date" />
 </picture>
</a>

## èµèµæ”¯æŒ

æ¬¢è¿æ”¯æŒä½œè€…ï¼Œçƒ¦è¯·åœ¨å¤‡æ³¨ä¸­è¯´æ˜ä¸€ä¸‹èµèµåŸå› å“Ÿ

<p align="center">
  <img src="./images/èµèµç .jpg" alt="èµèµç " style="width: 250px;">
</p>